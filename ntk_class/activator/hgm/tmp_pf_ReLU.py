#Do pip3 install --upgrade --force-reinstall scipy on Ubuntu 20.04
# P11, P12, P22 are Pfaffian matrices for erf. x11, x12, x22 are x_{11}, x_{12}, x_{22}.
#Use this code to build your own function.
def f_relu(t,f):
  d1=-((x12)**(2))+(x22)*(x11)
  d2=(x12)**(2)+(x22)*(x11)
  p11=np.array([[0,1,0,0,0],[(-1/2)/((x11)**(2)),(((1/2)*((x12)**(4)))-(((5/2)*((x22)**(2)))*((x11)**(2))))/(((d2)*(d1))*(x11)),(-((x12)**(3))+(((1/2)*(x22))*(x11))*(x12))/((d2)*((x11)**(2))),(((2)*((x22)**(2)))*((x12)**(2)))/(((d2)*(d1))*(x11)),(-((x12)**(4))+(((3)*(x22))*(x11))*((x12)**(2)))/((d2)*((x11)**(2)))],[0,((2)*((x12)**(3)))/((d2)*(d1)),(-((3/2)*(x22)))/(d2),(-(((2)*((x22)**(2)))*(x12)))/((d2)*(d1)),(-(((4)*(x22))*(x12)))/(d2)],[0,0,0,0,1],[(-((x22)*((x12)**(2))))/((d1)**(3)),((-((3/2)*((x12)**(6)))+(((3)*(x22))*(x11))*((x12)**(4)))-((((5/2)*((x22)**(2)))*((x11)**(2)))*((x12)**(2))))/((d2)*((d1)**(3))),((-(((5)*(x22))*((x12)**(5)))+(((19/4)*((x22)**(2)))*(x11))*((x12)**(3)))-((((3/4)*((x22)**(3)))*((x11)**(2)))*(x12)))/((d2)*((d1)**(3))),(((((7/2)*((x22)**(2)))*((x12)**(4)))-((((4)*((x22)**(3)))*(x11))*((x12)**(2))))-(((1/2)*((x22)**(4)))*((x11)**(2))))/((d2)*((d1)**(3))),((-(((19/2)*(x22))*((x12)**(2))))-(((5/2)*((x22)**(2)))*(x11)))/((d2)*(d1))]])
  p12=np.array([[0,0,1,0,0],[0,((2)*((x12)**(3)))/((d2)*(d1)),(-((3/2)*(x22)))/(d2),(-(((2)*((x22)**(2)))*(x12)))/((d2)*(d1)),(-(((4)*(x22))*(x12)))/(d2)],[0,0,0,0,4],[0,(-(((2)*((x11)**(2)))*(x12)))/((d2)*(d1)),(-((3/2)*(x11)))/(d2),((2)*((x12)**(3)))/((d2)*(d1)),(-(((4)*(x11))*(x12)))/(d2)],[((d2)*(x12))/((d1)**(3)),(-((((3)*(x22))*((x11)**(2)))*((x12)**(3)))+(((5)*((x22)**(2)))*((x11)**(3)))*(x12))/((d2)*((d1)**(3))),(((7/2)*((x12)**(6))+(((19/4)*(x22))*(x11))*((x12)**(4)))-((((17/2)*((x22)**(2)))*((x11)**(2)))*((x12)**(2)))+((9/4)*((x22)**(3)))*((x11)**(3)))/((d2)*((d1)**(3))),(-((((3)*((x22)**(2)))*(x11))*((x12)**(3)))+(((5)*((x22)**(3)))*((x11)**(2)))*(x12))/((d2)*((d1)**(3))),((8)*((x12)**(3))+(((16)*(x22))*(x11))*(x12))/((d2)*(d1))]])
  p22=np.array([[0,0,0,1,0],[0,0,0,0,1],[0,(-(((2)*((x11)**(2)))*(x12)))/((d2)*(d1)),(-((3/2)*(x11)))/(d2),((2)*((x12)**(3)))/((d2)*(d1)),(-(((4)*(x11))*(x12)))/(d2)],[(-1/2)/((x22)**(2)),(((2)*((x11)**(2)))*((x12)**(2)))/(((d2)*(d1))*(x22)),(-((x12)**(3))+(((1/2)*(x22))*(x11))*(x12))/((d2)*((x22)**(2))),(((1/2)*((x12)**(4)))-(((5/2)*((x22)**(2)))*((x11)**(2))))/(((d2)*(d1))*(x22)),(-((x12)**(4))+(((3)*(x22))*(x11))*((x12)**(2)))/((d2)*((x22)**(2)))],[(-((x11)*((x12)**(2))))/((d1)**(3)),(((((7/2)*((x11)**(2)))*((x12)**(4)))-((((4)*(x22))*((x11)**(3)))*((x12)**(2))))-(((1/2)*((x22)**(2)))*((x11)**(4))))/((d2)*((d1)**(3))),((-(((5)*(x11))*((x12)**(5)))+(((19/4)*(x22))*((x11)**(2)))*((x12)**(3)))-((((3/4)*((x22)**(2)))*((x11)**(3)))*(x12)))/((d2)*((d1)**(3))),((-((3/2)*((x12)**(6)))+(((3)*(x22))*(x11))*((x12)**(4)))-((((5/2)*((x22)**(2)))*((x11)**(2)))*((x12)**(2))))/((d2)*((d1)**(3))),((-(((19/2)*(x11))*((x12)**(2))))-(((5/2)*(x22))*((x11)**(2))))/((d2)*(d1))]])
