#Do pip3 install --upgrade --force-reinstall scipy on Ubuntu 20.04
import numpy as np
from scipy.integrate import solve_ivp
def nc2(x):
  return (np.pi/np.sqrt(x[0]*x[2]-x[1]**2))
# z: initial value, x: evaluation point
def f_erf_diff_fg(t,z,x):
  p11=x[0]; p12=x[1]; p22=x[2];
  d1=((((((-(p22))-(1)) )*(p11)+(p12)**(2)+(-(p22))-(1)) )*((t)**(2))+((p11+p22+2) )*(t))-(1)
  d2=((((((-(p22))-(1)) )*(p11)+(p12)**(2)+(-(p22))-(1)) )*((t)**(2))+((p11+(2)*(p22)+3) )*(t))-(2)
  d3=((((((-(p22))-(1)) )*(p11)+(p12)**(2)+(-(p22))-(1)) )*((t)**(2))+(((2)*(p11)+p22+3) )*(t))-(2)
  d4=((((((-(p22))-(1)) )*(p11)+(p12)**(2)+(-(p22))-(1)) )*((t)**(2))+(((2)*(p11)+(2)*(p22)+4) )*(t))-(4)
  d5=(((((((-((p22)**(2)))-((2)*(p22)))-(1)) )*((p11)**(2))+((((-((2)*((p22)**(2))))-((4)*(p22)))-(2)) )*(p11)+(p12)**(4)+((-((p22)**(2)))-((2)*(p22)))-(1)) )*((t)**(4))+(((((3)*(p22)+3) )*((p11)**(2))+(((3)*((p22)**(2))+(12)*(p22)+9) )*(p11)+(3)*((p22)**(2))+(9)*(p22)+6) )*((t)**(3))+((-((2)*((p11)**(2)))+(((-((9)*(p22)))-(13)) )*(p11)+((-((2)*((p22)**(2))))-((13)*(p22)))-(13)) )*((t)**(2))+(((6)*(p11)+(6)*(p22)+12) )*(t))-(4)
  d6=(((p22+1) )*(t))-(2)
  d7=(((p11+1) )*(t))-(2)
  p=np.array([[(((((((-((1/2)*((p22)**(2))))-(p22))-(1/2)) )*(p11)+((p22+1) )*((p12)**(2))+((-((1/2)*((p22)**(2))))-(p22))-(1/2)) )*((t)**(2))+((((((-(d6)+1) )*(p22)+-(d6)+1) )*(p11)+(p22)**(2)+((-(d6)+3) )*(p22)+-(d6)+2) )*(t)+(d6)*(p11)+-((2)*(p22))+(d6)-(2))/((((((d7)*(d6))*(p22)+(d7)*(d6)) )*(t))-((d7)*(d6))),(((((((((-((p22)**(2)))-((2)*(p22)))-(1)) )*(p12))*(p11)+(((1/2)*(p22)+1/2) )*((p12)**(3))+((((-((p22)**(2)))-((2)*(p22)))-(1)) )*(p12)) )*((t)**(3))+(((((((-((1/2)*(d6))+3/2) )*(p22)+-((1/2)*(d6))+3/2) )*(p12))*(p11)+(((2)*((p22)**(2))+((-((1/2)*(d6))+11/2) )*(p22)+-((1/2)*(d6))+7/2) )*(p12)) )*((t)**(2))+(((((1/2)*(d6))*(p12))*(p11)+((((((d7)*(d6))-(3)) )*(p22)+(((d7+1/2) )*(d6))-(3)) )*(p12)) )*(t))-(((d7)*(d6))*(p12)))/((((((d7)*(d6))*(p22)+(d7)*(d6)) )*(t))-((d7)*(d6)))],[((((((((5)*((p22)**(2))+(10)*(p22)+5) )*((p12)**(3)))*(p11)+(((-((2)*(p22)))-(2)) )*((p12)**(5))+(((5)*((p22)**(2))+(10)*(p22)+5) )*((p12)**(3))) )*((t)**(5))+(((((((-(d6)+1) )*((p22)**(2))+((-((2)*(d6))+2) )*(p22)+-(d6)+1) )*(p12))*((p11)**(2))+((((((((4)*(d6))-(8)) )*(p22)+((4)*(d6))-(8)) )*((p12)**(3))+((((-((2)*(d6))+2) )*((p22)**(2))+((-((4)*(d6))+4) )*(p22)+-((2)*(d6))+2) )*(p12)) )*(p11)+((-((10)*((p22)**(2)))+((((4)*(d6))-(28)) )*(p22)+((4)*(d6))-(18)) )*((p12)**(3))+((((-(d6)+1) )*((p22)**(2))+((-((2)*(d6))+2) )*(p22)+-(d6)+1) )*(p12)) )*((t)**(4))+(((((((((3)*(d6))-(2)) )*(p22)+((3)*(d6))-(2)) )*(p12))*((p11)**(2))+((-(((4)*(d6))*((p12)**(3)))+((((((((2)*(d7)+2) )*(d6))-(4)) )*((p22)**(2))+((((((4)*(d7)+10) )*(d6))-(12)) )*(p22)+((((2)*(d7)+8) )*(d6))-(8)) )*(p12)) )*(p11)+((((-(((8)*(d7))*(d6))+16) )*(p22)+(((-((8)*(d7)))-(4)) )*(d6)+16) )*((p12)**(3))+((((((((2)*(d7)+2) )*(d6))-(4)) )*((p22)**(2))+((((((4)*(d7)+7) )*(d6))-(10)) )*(p22)+((((2)*(d7)+5) )*(d6))-(6)) )*(p12)) )*((t)**(3))+((-((((2)*(d6))*(p12))*((p11)**(2)))+((((((((-((6)*(d7)))-(6)) )*(d6)+8) )*(p22)+(((-((6)*(d7)))-(10)) )*(d6)+8) )*(p12))*(p11)+(((8)*(d7))*(d6))*((p12)**(3))+((((-(((4)*(d7))*(d6))+4) )*((p22)**(2))+(((((-((14)*(d7)))-(6)) )*(d6)+16) )*(p22)+(((-((10)*(d7)))-(8)) )*(d6)+12) )*(p12)) )*((t)**(2))+(((((((4)*(d7)+4) )*(d6))*(p12))*(p11)+(((((((12)*(d7))*(d6))-(8)) )*(p22)+((((16)*(d7)+4) )*(d6))-(8)) )*(p12)) )*(t))-((((8)*(d7))*(d6))*(p12)))/((((((((d7)*(d6))*(d4))*(d2))*(p22)+(((d7)*(d6))*(d4))*(d2)) )*(t))-((((d7)*(d6))*(d4))*(d2))),(((((((((-((3/2)*((p22)**(4))))-((6)*((p22)**(3))))-((9)*((p22)**(2))))-((6)*(p22)))-(3/2)) )*((p11)**(3))+(((((((-((3/2)*((p22)**(3))))-((9/2)*((p22)**(2))))-((9/2)*(p22)))-(3/2)) )*((p12)**(2))+((((-((9/2)*((p22)**(4))))-((18)*((p22)**(3))))-((27)*((p22)**(2))))-((18)*(p22)))-(9/2)) )*((p11)**(2))+(((((4)*((p22)**(2))+(8)*(p22)+4) )*((p12)**(4))+(((((-((3)*((p22)**(3))))-((9)*((p22)**(2))))-((9)*(p22)))-(3)) )*((p12)**(2))+((((-((9/2)*((p22)**(4))))-((18)*((p22)**(3))))-((27)*((p22)**(2))))-((18)*(p22)))-(9/2)) )*(p11)+(((-(p22))-(1)) )*((p12)**(6))+(((4)*((p22)**(2))+(8)*(p22)+4) )*((p12)**(4))+(((((-((3/2)*((p22)**(3))))-((9/2)*((p22)**(2))))-((9/2)*(p22)))-(3/2)) )*((p12)**(2))+((((-((3/2)*((p22)**(4))))-((6)*((p22)**(3))))-((9)*((p22)**(2))))-((6)*(p22)))-(3/2)) )*((t)**(6))+((((((-((3/2)*(d6))+7) )*((p22)**(3))+((-((9/2)*(d6))+21) )*((p22)**(2))+((-((9/2)*(d6))+21) )*(p22)+-((3/2)*(d6))+7) )*((p11)**(3))+((((((-((1/2)*(d6))+9/2) )*((p22)**(2))+((-(d6)+9) )*(p22)+-((1/2)*(d6))+9/2) )*((p12)**(2))+(9)*((p22)**(4))+((-((9/2)*(d6))+57) )*((p22)**(3))+((-((27/2)*(d6))+117) )*((p22)**(2))+((-((27/2)*(d6))+99) )*(p22)+-((9/2)*(d6))+30) )*((p11)**(2))+((((((((2)*(d6))-(6)) )*(p22)+((2)*(d6))-(6)) )*((p12)**(4))+(((6)*((p22)**(3))+((-(d6)+27) )*((p22)**(2))+((-((2)*(d6))+36) )*(p22)+-(d6)+15) )*((p12)**(2))+(18)*((p22)**(4))+((-((9/2)*(d6))+93) )*((p22)**(3))+((-((27/2)*(d6))+171) )*((p22)**(2))+((-((27/2)*(d6))+135) )*(p22)+-((9/2)*(d6))+39) )*(p11)+((-((8)*((p22)**(2)))+((((2)*(d6))-(22)) )*(p22)+((2)*(d6))-(14)) )*((p12)**(4))+(((6)*((p22)**(3))+((-((1/2)*(d6))+45/2) )*((p22)**(2))+((-(d6)+27) )*(p22)+-((1/2)*(d6))+21/2) )*((p12)**(2))+(9)*((p22)**(4))+((-((3/2)*(d6))+43) )*((p22)**(3))+((-((9/2)*(d6))+75) )*((p22)**(2))+((-((9/2)*(d6))+57) )*(p22)+-((3/2)*(d6))+16) )*((t)**(5))+((((((((6)*(d6))-(21/2)) )*((p22)**(2))+((((12)*(d6))-(21)) )*(p22)+((6)*(d6))-(21/2)) )*((p11)**(3))+((((((((3/2)*(d6))-(4)) )*(p22)+((3/2)*(d6))-(4)) )*((p12)**(2))+((((6)*(d6))-(42)) )*((p22)**(3))+((((36)*(d6))-(315/2)) )*((p22)**(2))+((((54)*(d6))-(189)) )*(p22)+((24)*(d6))-(147/2)) )*((p11)**(2))+((-(((2)*(d6))*((p12)**(4)))+((((((((7)*(d7)+1) )*(d6))-(18)) )*((p22)**(2))+((((((14)*(d7)+5) )*(d6))-(44)) )*(p22)+((((7)*(d7)+4) )*(d6))-(26)) )*((p12)**(2))+-((18)*((p22)**(4)))+((((12)*(d6))-(156)) )*((p22)**(3))+((((54)*(d6))-(783/2)) )*((p22)**(2))+((((72)*(d6))-(387)) )*(p22)+((30)*(d6))-(267/2)) )*(p11)+((((-(((7)*(d7))*(d6))+12) )*(p22)+(((-((7)*(d7)))-(2)) )*(d6)+12) )*((p12)**(4))+((-((6)*((p22)**(3)))+((((((7)*(d7)+1) )*(d6))-(36)) )*((p22)**(2))+((((((14)*(d7)+7/2) )*(d6))-(58)) )*(p22)+((((7)*(d7)+5/2) )*(d6))-(28)) )*((p12)**(2))+-((18)*((p22)**(4)))+((((6)*(d6))-(114)) )*((p22)**(3))+((((24)*(d6))-(489/2)) )*((p22)**(2))+((((30)*(d6))-(219)) )*(p22)+((12)*(d6))-(141/2)) )*((t)**(4))+((((((-((15/2)*(d6))+5) )*(p22)+-((15/2)*(d6))+5) )*((p11)**(3))+((-((d6)*((p12)**(2)))+((-((24)*(d6))+63) )*((p22)**(2))+((-((141/2)*(d6))+141) )*(p22)+-((93/2)*(d6))+78) )*((p11)**(2))+(((((((((-((18)*(d7)))-(3)) )*(d6)+16) )*(p22)+(((-((18)*(d7)))-(5)) )*(d6)+16) )*((p12)**(2))+((-((6)*(d6))+84) )*((p22)**(3))+((-((66)*(d6))+378) )*((p22)**(2))+((-((273/2)*(d6))+519) )*(p22)+-((153/2)*(d6))+225) )*(p11)+(((7)*(d7))*(d6))*((p12)**(4))+((((-(((14)*(d7))*(d6))+18) )*((p22)**(2))+(((((-((46)*(d7)))-(3)) )*(d6)+52) )*(p22)+(((-((32)*(d7)))-(4)) )*(d6)+34) )*((p12)**(2))+(12)*((p22)**(4))+((-((6)*(d6))+132) )*((p22)**(3))+((-((42)*(d6))+387) )*((p22)**(2))+((-((147/2)*(d6))+431) )*(p22)+-((75/2)*(d6))+164) )*((t)**(3))+((((3)*(d6))*((p11)**(3))+((((((30)*(d6))-(30)) )*(p22)+((39)*(d6))-(30)) )*((p11)**(2))+((((((11)*(d7)+2) )*(d6))*((p12)**(2))+((((24)*(d6))-(126)) )*((p22)**(2))+((((108)*(d6))-(312)) )*(p22)+((93)*(d6))-(186)) )*(p11)+(((((((36)*(d7))*(d6))-(16)) )*(p22)+((((47)*(d7)+2) )*(d6))-(16)) )*((p12)**(2))+-((56)*((p22)**(3)))+((((24)*(d6))-(294)) )*((p22)**(2))+((((78)*(d6))-(450)) )*(p22)+((57)*(d6))-(212)) )*((t)**(2))+((-(((12)*(d6))*((p11)**(2)))+((((-((30)*(d6))+60) )*(p22)+-((54)*(d6))+60) )*(p11)+-((((22)*(d7))*(d6))*((p12)**(2)))+(84)*((p22)**(2))+((-((30)*(d6))+228) )*(p22)+-((42)*(d6))+144) )*(t)+((12)*(d6))*(p11)+-((40)*(p22))+((12)*(d6))-(40))/((((((((d7)*(d6))*(d4))*(d2))*(p22)+(((d7)*(d6))*(d4))*(d2)) )*(t))-((((d7)*(d6))*(d4))*(d2)))]])
  return (p@z)
# t_span=[0.0,1.0]
# iv=[0,1/2]
# x=[-0.2,-0.05,-0.15] #sample pt
# #x=[-2,-0.5,-1.5] #sample pt
# #x=[-2,-0.1,-2] #sample pt
# #x=[-10,-7,-5] #sample pt
# #x=[-10,-6,-5] #sample pt
# sol = solve_ivp(f_erf_diff_fg,t_span,iv,method='RK45',args=(x,),rtol=1e-10,atol=1e-10)
# print(sol)
# print(sol.y[0,-1])
# print('x=',x,end=', ')
# print('f=x*diff(erf), g=1+erf(x); E[fg]=',sol.y[0,-1]/nc2(x))
